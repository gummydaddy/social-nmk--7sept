{% extends 'landing_page.html' %}
{% load static %}
{% load custom_filters %}

{% for media in page_obj %}
    <div class="col media-item" data-id="{{ media.id }}" data-url="{% url 'user_profile:media_detail_view' media.id %}">
        <a href="{% url 'user_profile:profile' user_id=media.user.id %}">
            {{ media.user.username }}
        </a>
        <div class="media-content">
            {% if media.file.url|is_video %}
                <video controls class="img-fluid autoplay-video" unmute>
                    <source src="{{ media.file.url }}" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            {% else %}
                <img src="{{ media.file.url }}" alt="media" class="img-fluid">
            {% endif %}
            <div class="description">
                <a href="{% url 'user_profile:like_media' media.id %}"
                   class="like-link {% if request.user in media.likes.all %}liked{% endif %}"
                   data-url="{% url 'user_profile:like_media' media.id %}"
                   data-media-id="{{ media.id }}"
                   data-csrf-token="{{ csrf_token }}">
                    {% if request.user in media.likes.all %}
                        ❤️
                    {% else %}
                        ♡
                    {% endif %}
                </a>
                <span class="like-count">{{ media.likes.count }}</span> likes
                <a href="{% url 'user_profile:media_detail_view' media.id %}">Comment</a>
                <p>{{ media.description|safe }}</p>
            </div>
        </div>
    </div>
{% endfor %}
